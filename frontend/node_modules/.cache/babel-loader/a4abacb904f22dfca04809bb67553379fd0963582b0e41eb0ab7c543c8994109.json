{"ast":null,"code":"import _objectSpread from\"C:/Users/Sumit/Desktop/Biomerkin/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useCallback,useEffect}from'react';import{useNavigate}from'react-router-dom';import{motion,AnimatePresence}from'framer-motion';import{useDropzone}from'react-dropzone';import{Upload,FileText,Dna,Brain,Zap,CheckCircle,AlertCircle,Loader,Play,X,Download,Info}from'lucide-react';import{analysisService}from'../services/api';import{useWebSocket}from'../services/websocket';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AnalysisPage=()=>{const navigate=useNavigate();const[uploadedFile,setUploadedFile]=useState(null);const[isAnalyzing,setIsAnalyzing]=useState(false);const[workflowId,setWorkflowId]=useState(null);const[progress,setProgress]=useState({});const[socket,setSocket]=useState(null);const[error,setError]=useState(null);// WebSocket connection for real-time progress\nconst{connectionState,lastMessage}=useWebSocket(workflowId);useEffect(()=>{if(lastMessage&&lastMessage.data){const{data}=lastMessage;if(data.type==='workflow-progress'){setProgress(data.progress);}else if(data.type==='workflow-complete'){setIsAnalyzing(false);navigate(\"/results/\".concat(workflowId));}else if(data.type==='workflow-error'){setError(data.error);setIsAnalyzing(false);}}},[lastMessage,navigate,workflowId]);const onDrop=useCallback(acceptedFiles=>{const file=acceptedFiles[0];if(file){setUploadedFile(file);setError(null);}},[]);const{getRootProps,getInputProps,isDragActive}=useDropzone({onDrop,accept:{'text/plain':['.fasta','.fa','.txt'],'application/octet-stream':['.gb','.gbk']},maxFiles:1,maxSize:10*1024*1024// 10MB\n});const startAnalysis=async()=>{if(!uploadedFile)return;setIsAnalyzing(true);setError(null);try{const formData=new FormData();formData.append('sequence_file',uploadedFile);const response=await analysisService.startAnalysis(formData);setWorkflowId(response.data.workflow_id);}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||'Failed to start analysis');setIsAnalyzing(false);}};const loadSampleData=async sampleType=>{try{const response=await analysisService.getSampleData();const sampleFile=response.data.samples.find(s=>s.type===sampleType);if(sampleFile){// Create a mock file object for the sample\nconst mockFile=new File([sampleFile.content],sampleFile.filename,{type:'text/plain'});setUploadedFile(mockFile);setError(null);}}catch(err){setError('Failed to load sample data');}};const removeFile=()=>{setUploadedFile(null);setError(null);};const agents=[{name:'GenomicsAgent',description:'Analyzing DNA sequence for genes and mutations',icon:Dna,color:'from-green-500 to-emerald-500'},{name:'ProteomicsAgent',description:'Predicting protein structure and function',icon:Brain,color:'from-blue-500 to-cyan-500'},{name:'LiteratureAgent',description:'Researching scientific literature',icon:FileText,color:'from-purple-500 to-pink-500'},{name:'DrugAgent',description:'Identifying drug candidates and clinical trials',icon:Zap,color:'from-orange-500 to-red-500'},{name:'DecisionAgent',description:'Generating comprehensive medical report',icon:CheckCircle,color:'from-indigo-500 to-purple-500'}];const getAgentStatus=agentName=>{const agentProgress=progress[agentName.toLowerCase()];if(!agentProgress)return'pending';if(agentProgress.status==='completed')return'completed';if(agentProgress.status==='processing')return'processing';if(agentProgress.status==='failed')return'failed';return'pending';};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto space-y-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-bold text-gray-900 mb-4\",children:\"Genomics Analysis\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-gray-600\",children:\"Upload your DNA sequence file and let our AI agents analyze it autonomously\"})]}),!isAnalyzing&&/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:\"bg-white rounded-xl shadow-lg p-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold text-gray-900 mb-6\",children:\"Upload DNA Sequence File\"}),!uploadedFile?/*#__PURE__*/_jsxs(\"div\",_objectSpread(_objectSpread({},getRootProps()),{},{className:\"border-2 border-dashed rounded-lg p-12 text-center cursor-pointer transition-all duration-200 \".concat(isDragActive?'border-blue-500 bg-blue-50':'border-gray-300 hover:border-blue-400 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({},getInputProps())),/*#__PURE__*/_jsx(Upload,{className:\"h-12 w-12 text-gray-400 mx-auto mb-4\"}),isDragActive?/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-blue-600 font-medium\",children:\"Drop your DNA sequence file here...\"}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-gray-600 mb-2\",children:\"Drag and drop your DNA sequence file here, or click to browse\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Supports FASTA (.fasta, .fa), GenBank (.gb, .gbk), and text files\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Maximum file size: 10MB\"})]})]})):/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(FileText,{className:\"h-8 w-8 text-blue-500\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-gray-900\",children:uploadedFile.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[(uploadedFile.size/1024).toFixed(1),\" KB\"]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:removeFile,className:\"p-2 text-gray-400 hover:text-red-500 transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"h-5 w-5\"})})]})}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"h-5 w-5 text-red-500 flex-shrink-0\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-700\",children:error})]}),uploadedFile&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 flex justify-center\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:startAnalysis,disabled:!uploadedFile,className:\"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-lg font-semibold text-lg hover:shadow-lg transform hover:scale-105 transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none\",children:[/*#__PURE__*/_jsx(Play,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Start Analysis\"})]})})]}),/*#__PURE__*/_jsx(AnimatePresence,{children:isAnalyzing&&/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:\"bg-white rounded-xl shadow-lg p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold text-gray-900 mb-2\",children:\"Analysis in Progress\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Our AI agents are working autonomously to analyze your sequence\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:agents.map((agent,index)=>{const Icon=agent.icon;const status=getAgentStatus(agent.name);return/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:index*0.1},className:\"flex items-center space-x-4 p-4 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 rounded-lg bg-gradient-to-r \".concat(agent.color,\" flex items-center justify-center\"),children:/*#__PURE__*/_jsx(Icon,{className:\"h-6 w-6 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-900\",children:agent.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:agent.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[status==='completed'&&/*#__PURE__*/_jsx(CheckCircle,{className:\"h-6 w-6 text-green-500\"}),status==='processing'&&/*#__PURE__*/_jsx(Loader,{className:\"h-6 w-6 text-blue-500 animate-spin\"}),status==='failed'&&/*#__PURE__*/_jsx(AlertCircle,{className:\"h-6 w-6 text-red-500\"}),status==='pending'&&/*#__PURE__*/_jsx(\"div\",{className:\"h-6 w-6 rounded-full border-2 border-gray-300\"})]})]},agent.name);})}),progress.overall&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Overall Progress\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-500\",children:[progress.overall.percentage,\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(motion.div,{className:\"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full\",initial:{width:0},animate:{width:\"\".concat(progress.overall.percentage,\"%\")},transition:{duration:0.5}})})]})]})}),!isAnalyzing&&/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.2},className:\"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold text-gray-900 mb-4\",children:\"Try Sample Data\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6\",children:\"Don't have a DNA sequence file? Try our sample data to see the system in action.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>loadSampleData('brca1'),className:\"p-4 bg-white rounded-lg border border-gray-200 hover:border-blue-300 hover:shadow-md transition-all duration-200 text-left group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-900\",children:\"BRCA1 Gene Sample\"}),/*#__PURE__*/_jsx(Download,{className:\"h-4 w-4 text-gray-400 group-hover:text-blue-500\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:\"Breast cancer susceptibility gene sequence\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 text-xs text-gray-500\",children:[/*#__PURE__*/_jsx(Info,{className:\"h-3 w-3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Contains pathogenic variants\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>loadSampleData('tp53'),className:\"p-4 bg-white rounded-lg border border-gray-200 hover:border-blue-300 hover:shadow-md transition-all duration-200 text-left group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-900\",children:\"TP53 Gene Sample\"}),/*#__PURE__*/_jsx(Download,{className:\"h-4 w-4 text-gray-400 group-hover:text-blue-500\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:\"Tumor suppressor gene sequence\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 text-xs text-gray-500\",children:[/*#__PURE__*/_jsx(Info,{className:\"h-3 w-3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Includes missense mutations\"})]})]})]})]})]});};export default AnalysisPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}